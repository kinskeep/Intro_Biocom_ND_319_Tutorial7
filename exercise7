####Exercise7####
#Question 1
#load dataset
import pandas
InFile=open("Lecture11.fasta","r")
InFile=close()
#create lists for storing information about sequences
sequenceID=[]
sequenceLength=[]
percentGC=[]
meltingTemp=[]

for Line in InFile:
# remove newline character from file line
    Line=Line.strip()
    print (Line)
    if '>' in Line:
        sequenceID.append(Line[1:])
    else:
        Seqlength = float(len(Line))
        print (Seqlength)
        sequenceLength.append(Seqlength)
        # count the number of G's and C's
        nG=Line.count("G")
        print (nG)
        nC=Line.count("C")
        print (nC)
#append values to list
        gcTotal = (nG+nC)/Seqlength*100
        percentGC.append(gcTotal)

#dataframe of resulting info
seqDF = pandas.DataFrame(list(zip(sequenceID,sequenceLength,percentGC)),columns=['sequenceID','sequenceLength','percentGC'])
InFile.close()

#Histogram of sequence lengths
import plotnine
from plotnine import *
p=(ggplot(data=seqDF) +
    aes(x="sequenceLength") +
    geom_histogram(binwidth=5))

#Question 2


#Question 3
#load the dataset
import pandas
import numpy
Data = pandas.read_csv("data.txt", sep=',')
print (Data)
#create lists for storing information about sequences
import plotnine
from plotnine import *
d=ggplot(Data)+theme_classic()+xlab("region")+ylab("Average")
d+geom_bar(aes(x="factor(region)",y="observations"),stat="summary",fun_y=numpy.mean)
